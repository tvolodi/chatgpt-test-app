# DOCUMENT_TYPE: REQUIREMENT
# REQ_ID: REQ-009
# VERSION: 1.0

## 1. Summary

- Title: Categories Management
- Type: functional
- Priority: high
- Status: draft

## 2. Description

The **Categories** entity represents a hierarchical classification system for content (e.g., articles, products). Unlike tags, categories are structured in a tree hierarchy, allowing for parent-child relationships. This requirement covers both the data entity and the management UI.

## 3. Data Model

### Attributes

| Attribute | Type | Constraints | Description |
| :--- | :--- | :--- | :--- |
| **Id** | UUID | Primary Key | Unique identifier for the category. Automatically generated. |
| **Code** | Text | Unique, Not Null | A system-unique slug for the category (e.g., `software-development`, `web`). Used for URLs. |
| **Name** | JSONB | Not Null, Default `{}` | Localized display name. Follows **ADR-0002**. |
| **ParentId** | UUID | Foreign Key (Self) | Reference to the parent category. Nullable (for root categories). |
| **DeletedAt** | Timestamp | Nullable | Timestamp when the category was soft-deleted. Null means active. |

### Relationships
- **Self-Referencing**: A category can have one parent and multiple children.
- **On Delete**: Soft delete. If a parent is soft-deleted, its children remain but might become "orphaned" or hidden depending on logic (Decision: Hide children of deleted parents in tree).

## 4. User Stories

- **US-1**: As an Admin/Content Manager, I want to view categories in a hierarchical tree structure so I can understand the organization.
- **US-2**: As an Admin/Content Manager, I want to add a new category, optionally selecting a parent.
- **US-3**: As an Admin/Content Manager, I want to update a category's name or move it to a different parent.
- **US-4**: As an Admin/Content Manager, I want to soft-delete a category so I can restore it if needed.

## 5. Functional Requirements

### 5.1. Master-Detail UI
- **FR-1**: The UI must be a **Master-Detail** layout.
    - **Master (Left)**: A collapsible tree view of all categories.
    - **Detail (Right)**: A form to view/edit the selected category or create a new one.

### 5.2. Tree View (Master)
- **FR-2**: Display hierarchy visually (indentation or collapsible nodes).
- **FR-3**: Display localized names in the tree.
- **FR-4**: Allow selection of a node to populate the Detail view.
- **FR-5**: Filter out soft-deleted categories by default.

### 5.3. Detail Form
- **FR-6**: **Code Field**: Unique text identifier.
- **FR-7**: **Name Fields**: Localized inputs (EN, RU, KK).
- **FR-8**: **Parent Selection**: A dropdown or tree-select to choose the parent category.

### 5.4. Actions
- **FR-9**: **Create**: Button to add a root category or child of selected category.
- **FR-10**: **Update**: Save changes to the selected category.
- **FR-11**: **Delete**: Soft delete the category.
    - *Constraint*: Prevent deletion if the category has active children.

## 6. Non-Functional Constraints

- **Permissions**: Restricted to `ADMIN` or `CONTENT_MANAGER` roles.
- **Performance**: Tree retrieval should be optimized.
- **Styling**: Must use **Tailwind CSS** and match the modern design of the Tags page (cards, shadows, rounded corners).

## 7. Traceability

- **Related ADRs**: ADR-0002 (Database Localization)
- **Related Modules**: MOD-BE-Categories, MOD-FE-Categories
