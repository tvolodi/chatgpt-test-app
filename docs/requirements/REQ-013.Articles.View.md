# DOCUMENT_TYPE: REQUIREMENT
# REQ_ID: REQ-013
# VERSION: 1.0

## 1. Summary

- Title: Public Article View & Interaction
- Type: Functional
- Priority: High
- Status: **DRAFT**

## 2. Description

This requirement covers the detailed view of an article and user interactions.
It introduces a **Master-Detail** layout for the `/articles` page, where the list of articles serves as the "Master" view and the selected article is displayed in a "Detail" panel on the same page.
It also adds social interactions: **Likes/Dislikes** and **Comments**.

## 3. User Stories

- **US-13.1**: As a visitor, I want to view the full content of an article with proper formatting so I can read it comfortably.
- **US-13.2**: As a visitor, I want to see the article list and the selected article side-by-side (or in a split view) so I can easily switch between articles without navigating back and forth.
- **US-13.3**: As a visitor, I want to see which article is currently selected in the list.
- **US-13.4**: As a visitor, I want to "Like" or "Dislike" an article to express my opinion.
- **US-13.5**: As a visitor, I want to leave a comment on an article to engage in discussion.
- **US-13.6**: As a visitor, when I click "Read more" on the home page, I want to be taken to the specific article in the Master-Detail view.

## 4. Technical Specifications

### 4.1. Frontend (Next.js)
- **Page**: Refactor `web/src/app/[locale]/articles/page.tsx` to support Master-Detail layout.
    - **Layout**: Split screen (e.g., Left: List (30%), Right: Detail (70%)) on desktop. Stacked or Modal on mobile.
    - **State**: URL state management (e.g., `?id=...` or `/articles/[id]` keeping the layout).
- **Components**:
    - `ArticleDetailPanel`: Displays rendered Markdown, Author, Date, Tags.
    - `LikeDislikeControl`: Buttons for Like/Dislike with counters.
    - `CommentSection`: List of comments and a form to add new ones.
- **Navigation**:
    - "Read more" on Landing Page -> Navigates to `/articles?selectedId=...` (or similar).

### 4.2. Backend (Go)
- **API**:
    - `GET /api/articles/{id}`: Fetch single article details (public).
    - `POST /api/articles/{id}/likes`: Toggle Like/Dislike.
    - `GET /api/articles/{id}/comments`: Fetch comments.
    - `POST /api/articles/{id}/comments`: Add a comment.
- **Database**:
    - New Table: `comments` (id, article_id, user_id (nullable?), body, created_at).
    - New Table: `article_likes` (article_id, user_id (nullable/session_id?), type (LIKE/DISLIKE)).

### 4.3. Authentication & Permissions
- **Likes/Dislikes**: User **MUST** be registered and logged in to like or dislike.
- **Comments**: User **MUST** be registered and logged in to comment.
- **Anonymous Users**: Can only view articles and existing comments/likes. Attempting to interact should prompt login.

## 5. Acceptance Criteria

### 5.1. Master-Detail Layout (MUST PASS)
- **AC-1.1**: `/articles` displays list. Clicking an item opens it in the Detail panel *without* leaving the page.
- **AC-1.2**: The selected item in the list is visually highlighted.
- **AC-1.3**: Direct link to an article (e.g. from Home Page) opens the page with that article selected and loaded in the Detail panel.

### 5.2. Interactions (MUST PASS)
- **AC-2.1**: User can click Like/Dislike. Counter updates.
- **AC-2.2**: User can view comments.
- **AC-2.3**: User can post a comment.

## 6. Verification & Testing Guide

### 6.1. Automated Tests
- **E2E Test**: `web/tests/req-013-article-view.spec.ts`
    - Verify Master-Detail switching.
    - Verify "Read more" navigation.
    - Verify Like/Comment UI interactions.
- **Backend Test**: Integration tests for Likes and Comments APIs.

## 7. Traceability
- **Dependencies**: REQ-012 (Public List)
