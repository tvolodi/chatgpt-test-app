# DOCUMENT_TYPE: REQUIREMENT
# REQ_ID: REQ-010
# VERSION: 1.0

## 1. Summary

- Title: Articles Management
- Type: functional
- Priority: high
- Status: implemented

## 2. Description

The **Articles** entity represents the core content of the portal. It allows users to create, manage, and publish rich text content with multimedia support. It integrates with **Categories** (REQ-009) and **Tags** (REQ-007).

## 3. Data Model

### 3.1. Entity: `Article`

| Attribute | Type | Description |
| :--- | :--- | :--- |
| `id` | UUID | Unique identifier (Primary Key). |
| `title` | String | The headline of the article. |
| `body` | Text | The main content (Markdown format recommended). |
| `category_id` | UUID | Foreign Key to `categories`. |
| `author_id` | UUID | Foreign Key to `users` (system user). |
| `status` | Enum | `DRAFT`, `PUBLISHED`, `ARCHIVED`. |
| `published_at` | Timestamp | Date and time when status changed to `PUBLISHED`. |
| `created_at` | Timestamp | Automatically set on creation. |
| `updated_at` | Timestamp | Automatically updated on save. |
| `deleted_at` | Timestamp | Soft delete timestamp (nullable). |

### 3.2. Relationships
- **One-to-Many**: Category -> Articles (An article belongs to one category).
- **Many-to-Many**: Articles <-> Tags (An article can have multiple tags).
- **Many-to-One**: User -> Articles (An article has one author).

## 4. Functional Requirements

### 4.1. Article Management UI
- **List View**:
    - Display columns: Title, Category, Author, Status, Published At, Updated At.
    - Filters: Category, Status, Author.
    - Pagination support.
- **Create/Edit Form**:
    - **Title**: Text input.
    - **Body**: Markdown Editor (with preview).
    - **Category**: Dropdown (Tree selector preferred).
    - **Tags**: Multi-select (with autocomplete).
    - **Status**:
        - default: `DRAFT`.
        - Actions: "Save as Draft", "Publish".
- **Delete**:
    - Soft delete functionality (admin/content_manager only).

### 4.2. Business Logic
- **Author Assignment**: Automatically set `author_id` to the current logged-in user upon creation.
- **Timestamps**:
    - `created_at`: Set once on insert.
    - `updated_at`: Updated on every modification.
    - `published_at`: Set to `NOW()` when status transitions to `PUBLISHED`.
- **Versioning**: (Future Scope) Keep history of changes.

## 5. Non-Functional Requirements
- **Format**: Content stored as **Markdown**.
    - *Reasoning*: AI-friendly, secure, portable.
    - *Embeds*: Images via `![alt](url)`, Video/Audio via HTML tags `<video src="...">` (sanitized).
- **Performance**: Article load time < 200ms.
- **Security**: Sanitize HTML output to prevent XSS.

## 6. Acceptance Criteria
- AC-1: User can create an article with Title, Body, Category, and Tags.
- AC-2: User can save an article as `DRAFT` or `PUBLISHED`.
- AC-3: `published_at` is only set when published.
- AC-4: Article list shows correct status and filters.
- AC-5: Soft delete works (article hidden from list but exists in DB).

## 7. UI Specification

> **Design Subsystem Files:**
> - UI Manifest: [`docs/design/pages/UI-REQ-010-articles-mgmt.json`](../design/pages/UI-REQ-010-articles-mgmt.json)
> - Components: [`docs/design/components/COMPONENT-REGISTRY.json`](../design/components/COMPONENT-REGISTRY.json)
> - Design Tokens: [`docs/design/tokens/DESIGN-TOKENS.json`](../design/tokens/DESIGN-TOKENS.json)

Refer to the linked JSON files for detailed UI component structure, styling classes, and layout specifications.

## 8. Traceability
- **Related Modules**: MOD-BE-Articles, MOD-FE-Articles
- **Dependencies**: REQ-007 (Tags), REQ-009 (Categories), REQ-001 (Auth)
- **Implementation**:
  - Backend: `api/internal/modules/articles/` (repository, service, handler)
  - Frontend: `web/src/app/components/articles/` (ArticleList, ArticleEditor)
  - Pages: `web/src/app/[locale]/dashboard/articles/` (list, new, edit)
  - Tests: `web/tests/articles.spec.ts`
  - Migration: `api/internal/database/migrations/000003_create_articles_table.up.sql`

